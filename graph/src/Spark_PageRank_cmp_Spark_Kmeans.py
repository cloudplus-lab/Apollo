import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt


benchmark1 = "Benchmark: Spark PageRank"
benchmark2 = "Benchmark: Spark Kmeans"
# WordCount 18G18U CPU_overall
t1 = "18G18U"  
benchmark1_a1 = "1547717070000,99.829291053,0.0374718968575,0.0374734572114,0.0957635929308,0.0 1547717075000,99.8584717366,0.0208130410601,0.00832448885627,0.112390733484,0.0 1547717080000,98.0487042844,0.363594074223,0.831651531537,0.572213248928,0.183836860862 1547717085000,96.484586671,1.47201949989,1.01579998052,0.944075119392,0.0835187291464 1547717090000,94.2548269035,3.7903405733,0.950424330178,0.983574333818,0.0208338591811 1547717095000,93.6160076322,5.4016261133,0.928079353517,0.0542869010221,0.0 1547717100000,80.8968756701,17.6775048536,0.993802982959,0.406674680706,0.0251418126025"
benchmark1_b1 = "1547717070000,37031724,8373636,3889860 1547717075000,37037560,8367316,3890344 1547717080000,36632140,8757000,3906080 1547717085000,36091000,9186212,4018008 1547717090000,35188048,9845984,4261188 1547717095000,34923548,9594312,4777360 1547717100000,33898900,9902612,5493708"
benchmark2_a1 = "1547718150000,96.2124728769,0.0416224450604,0.191480400962,3.55442427712,0.0 1547718155000,99.8543076697,0.0249760652108,0.0249724263334,0.0957438387104,0.0 1547718160000,99.9583676759,0.0249823071462,0.00832396886836,0.0083260480413,0.0 1547718165000,99.9791869591,0.0124880324755,0.00832500845483,0.0,0.0 1547718170000,97.7848728422,0.699286850027,1.09709456717,0.326623697561,0.0921220430335 1547718175000,95.0166663897,3.69762155053,0.757018426913,0.524510757523,0.00418287530849 1547718180000,92.479642131,5.94088623385,1.33720432341,0.217191035923,0.0250762758553 1547718185000,95.3166932569,2.99170956176,0.493032709627,1.17767315995,0.0208913117523 1547718190000,76.7314887221,18.9530152703,1.77073238678,2.50718216158,0.0375814591817 1547718195000,87.7966126088,11.3855607791,0.705320215524,0.112506396627,0.0 1547718200000,90.5301643694,9.17797586783,0.183525253958,0.104161582711,0.00417292605575"
benchmark2_b1 = "1547718150000,34215244,10986944,4093032 1547718155000,34442552,10768848,4083820 1547718160000,34442552,10768856,4083812 1547718165000,34443672,10768856,4082692 1547718170000,33675596,11518588,4101036 1547718175000,33275768,11587852,4431600 1547718180000,32377664,11995812,4921744 1547718185000,31843152,12302344,5149724 1547718190000,29882140,12302524,7110556 1547718195000,29035988,12302744,7956488 1547718200000,28710428,12303108,8281684"
# WordCount 24G24U CPU_overall
t2 = "24G24U"
benchmark1_a2 = "1547800980000,99.9250666067,0.0374661767293,0.0374672165754,0.0,0.0 1547800985000,99.9500478706,0.0166510563663,0.0166505365082,0.0166505365082,0.0 1547800990000,99.9292363893,0.0333010731461,0.00832448859668,0.0291380489957,0.0 1547800995000,97.8871577106,0.292282081274,0.467706559831,1.30272780748,0.0501258408602 1547801000000,98.1353370145,0.660696063176,0.781845263905,0.359418910095,0.0627027483085 1547801005000,96.1183006763,3.37670771248,0.479994691672,0.0249969195554,0.0 1547801010000,94.2063241072,5.02550723914,0.751471722196,0.0083458521115,0.00835107937701 1547801015000,87.4668261317,11.3280313749,0.753244183784,0.38912944938,0.0627688601436"
benchmark1_b2 = "1547800980000,34846144,10460580,3988496 1547800985000,34885812,10421512,3987896 1547800990000,34885936,10421332,3987952 1547800995000,34631824,10668392,3995004 1547801000000,33997972,11283752,4013496 1547801005000,33711668,11240240,4343312 1547801010000,33088176,11444316,4762728 1547801015000,32145024,11750924,5399272"
benchmark2_a2 = "1547802265000,99.8126904298,0.0249750252347,0.0915756116929,0.0707589333134,0.0 1547802270000,99.7918227996,0.0333083520693,0.15405112832,0.0208177200433,0.0 1547802275000,97.513837661,0.796562943519,1.30391420721,0.222173714598,0.163511473627 1547802280000,95.5070908008,3.04131109854,0.920327162797,0.531270937897,0.0 1547802285000,91.9109597256,6.08499981437,1.386137866,0.588683729075,0.0292188649639 1547802290000,94.7521933731,2.90655553845,0.523407666933,1.80947136745,0.00837205408347 1547802295000,80.7666515549,16.6678256537,1.97591468343,0.556175497481,0.0334326104536 1547802300000,86.5420514181,12.347972954,1.05159530091,0.0500323847431,0.00834794223224 1547802305000,91.9858442562,7.52232378681,0.30018142751,0.191650529497,0.0"
benchmark2_b2 = "1547802265000,33535248,11600144,4159828 1547802270000,34310580,10842396,4142244 1547802275000,33522160,11612412,4160648 1547802280000,33236800,11656384,4402036 1547802285000,32322464,12064304,4908452 1547802290000,31887844,12294232,5113144 1547802295000,29836428,12370916,7087876 1547802300000,29062408,12371016,7861796 1547802305000,28858108,12371252,8065860"
# WordCount 30G30U CPU_overall
t3 = "30G30U"
benchmark1_a3 = "1547796525000,99.9042530468,0.0499547286733,0.0374661764695,0.0083260480413,0.0 1547796530000,99.8585013607,0.0166484578544,0.00832396899813,0.116526212421,0.0 1547796535000,96.9888849802,0.650007212171,1.01483886634,1.21628987066,0.129979070672 1547796540000,95.0345577945,3.65911969883,0.743243771975,0.550561491777,0.0125172429012 1547796545000,93.4425997506,4.48223137141,1.59642650199,0.461992823753,0.0167495522801 1547796550000,93.6128157881,5.79807969683,0.400998660697,0.167251666825,0.0208541875209 1547796555000,87.9984868475,8.74911776751,2.86791557727,0.380307404012,0.00417240372178 1547796560000,87.9942694885,6.5627015038,5.41376955714,0.0292594505566,0.0 1547796565000,86.7547670204,10.0273608061,2.93870296584,0.274976335524,0.0041928721174 1547796570000,90.7931178352,5.2631375305,1.65191856941,2.28346286523,0.00836319965538"
benchmark1_b3 = "1547796525000,31534380,13853792,3907048 1547796530000,31540584,13847440,3907196 1547796535000,30854508,14513368,3927344 1547796540000,30380500,14666400,4248320 1547796545000,29611788,15074332,4609100 1547796550000,29308268,15220076,4766876 1547796555000,28686912,15381776,5226532 1547796560000,28619412,15382584,5293224 1547796565000,28480344,15384364,5430512 1547796570000,28413912,15385504,5495804"
benchmark2_a3 = "1547797725000,99.8751321513,0.0124864730309,0.0915709337485,0.0166479377367,0.0041625041625 1547797730000,99.8917748918,0.01665001665,0.0582750582751,0.0333000333,0.0 1547797735000,98.132259597,0.502537377285,1.08879475855,0.129849447772,0.146558819383 1547797740000,97.2651732516,2.05016443586,0.605415187971,0.0708960451714,0.00835107937701 1547797745000,94.1343982453,4.41227095708,1.18590624482,0.259074519437,0.00835003340013 1547797750000,93.0560924284,4.90196500909,0.543975059111,1.48546437766,0.0125031257814 1547797755000,82.1883047698,11.7722535625,4.11132801978,1.91130026564,0.0168133822693 1547797760000,82.2136783595,11.8045420642,3.82068832408,2.12751995021,0.0335713019975 1547797765000,87.8370329754,9.82069108464,1.73834085922,0.603935080749,0.0 1547797770000,85.6470630581,11.6059477317,2.24902979155,0.493746941217,0.00421247735793 1547797775000,95.1037131307,3.17340304805,1.69370409933,0.0250078404458,0.00417188151856 1547797780000,93.2817861168,3.81968325872,1.47018321671,1.42834740778,0.0"
benchmark2_b3 = "1547797725000,30585172,14873740,3836308 1547797730000,31004796,14467860,3822564 1547797735000,30376848,15082104,3836268 1547797740000,30006404,15286812,4002004 1547797745000,29405188,15490648,4399384 1547797750000,28922648,15609580,4762992 1547797755000,27958164,15797540,5539516 1547797760000,26402620,15797576,7095024 1547797765000,25854028,15797680,7643512 1547797770000,25842128,15797716,7655376 1547797775000,25625980,15797812,7871428 1547797780000,25579912,15797972,7917336"
# WordCount 36G36U CPU_overall
t4 = "36G36U"
benchmark1_a4 = "1547774390000,99.9542124542,0.0208125208125,0.024975024975,0.0,0.0 1547774395000,99.8501638785,0.0249713875256,0.00832448885627,0.116540245086,0.0 1547774400000,97.8561828306,0.544319244341,0.858350184631,0.611352493763,0.129795246671 1547774405000,96.3674654609,2.85950715262,0.71885436403,0.0416625565365,0.0125104659152 1547774410000,93.7001554204,4.68662637719,1.5589276953,0.0375726272312,0.0167178799125 1547774415000,93.9627330706,4.6426800997,0.66854931773,0.700991055871,0.0250464560639 1547774420000,80.1636669625,16.240266578,2.30978306269,1.28628339685,0.0"
benchmark1_b4 = "1547774390000,34871964,10376180,4047076 1547774395000,34877808,10369784,4047628 1547774400000,34247808,10939524,4107888 1547774405000,33796100,11188720,4310400 1547774410000,32984380,11596488,4714352 1547774415000,32266476,11902980,5125764 1547774420000,31783280,11905776,5606164"
benchmark2_a4 = "1547775315000,99.03405831,0.0291442880726,0.162378216338,0.774419185611,0.0 1547775320000,99.8792593011,0.0208177208226,0.0749437929352,0.0249791851389,0.0 1547775325000,97.740647535,0.754544627595,1.2239581374,0.0880123699214,0.192837330131 1547775330000,96.5824444477,2.24087925156,1.12253343455,0.0499542090748,0.00418865711653 1547775335000,93.9418594866,4.68115478037,1.28938039371,0.0709136348766,0.0166917044846 1547775340000,94.202919502,4.37107398873,0.58970400364,0.81539179625,0.0209107093345 1547775345000,79.9930449771,17.6206456648,1.57976936424,0.764745330875,0.0417946629858 1547775350000,85.6981983033,12.1030847748,1.10181559908,1.08855390288,0.00834741989837 1547775355000,87.7656696786,10.3211372698,0.212764079696,1.70042897188,0.0"
benchmark2_b4 = "1547775315000,33395632,11694772,4204816 1547775320000,34111416,10995688,4188116 1547775325000,33366440,11707876,4220904 1547775330000,33097492,11808592,4389136 1547775335000,32274352,12216524,4804344 1547775340000,31531892,12522800,5240528 1547775345000,29587504,12523152,7184564 1547775350000,28678964,12523252,8093004 1547775355000,28411676,12523684,8359860"
# WordCount 42G42U CPU_overall
t5 = "42G42U" 
benchmark1_a5 = "1547776400000,99.9125848133,0.0416266011995,0.0457885855038,0.0,0.0 1547776405000,99.9292337896,0.0166510564961,0.0208140805168,0.0333010734058,0.0 1547776410000,96.739464575,0.959500382265,1.27414908525,0.846795156688,0.180090800824 1547776415000,94.5247846007,4.54421713334,0.497310845764,0.433687420219,0.0 1547776420000,92.2963054433,6.3343620811,0.918871284545,0.442101734408,0.00835945663532 1547776425000,96.2205383207,2.82097110061,0.535735908458,0.397637450976,0.0251172192959 1547776430000,76.4671771013,23.0143290395,0.489261798655,0.025048660304,0.00418340026774"
benchmark1_b5 = "1547776400000,35062092,10404696,3828432 1547776405000,35068492,10398160,3828568 1547776410000,34041128,11387240,3866852 1547776415000,33822592,11243604,4229024 1547776420000,33114204,11421156,4759860 1547776425000,32652988,11727660,4914572 1547776430000,31963508,11731576,5600136"
benchmark2_a5 = "1547777395000,99.5670065022,0.0333052324009,0.179020432908,0.220667832459,0.0 1547777400000,99.7834608582,0.0582968989421,0.129091712341,0.0249864664011,0.00416406412659 1547777405000,97.8733347913,0.796800850899,1.2123884018,0.0503471991945,0.0671287568057 1547777410000,95.4217987664,3.74766502296,0.58902039269,0.241515817915,0.0 1547777415000,93.1294570028,5.31732103917,1.07428647453,0.466390006129,0.0125454773554 1547777420000,86.8790653766,11.5417145631,0.984714442823,0.552668952326,0.0418366651322 1547777425000,84.5046468891,12.8618423686,2.57502241933,0.0250461132076,0.0334422097651 1547777430000,91.1592666625,7.41884460373,1.25041596531,0.171472768417,0.0 1547777435000,89.2261449374,9.64224363103,0.392711257731,0.738900173855,0.0"
benchmark2_b5 = "1547777395000,33792016,11518732,3984472 1547777400000,34482124,10844152,3968944 1547777405000,33708076,11601748,3985396 1547777410000,33374516,11633336,4287368 1547777415000,32697724,11837384,4760112 1547777420000,31550292,12143992,5600936 1547777425000,29617432,12144020,7533768 1547777430000,29387760,12144072,7763388 1547777435000,29186628,12144432,7964160"
# WordCount 48G48U CPU_overall
t6 = "48G48U" 
benchmark1_a6 = "1547778780000,99.5379017338,0.0374687761499,0.141543856678,0.283085633404,0.0 1547778785000,99.9417249412,0.0124875126173,0.0166505365082,0.0291370096688,0.0 1547778790000,96.6589779547,0.996403895063,1.43607456503,0.782928577414,0.125615007774 1547778795000,94.5121304121,4.52656769416,0.532016011559,0.429285882139,0.0 1547778800000,94.2791856422,4.81053668155,0.797540154713,0.104386442196,0.00835107937701 1547778805000,97.6545841069,1.65276741839,0.459019861765,0.221103562875,0.0125250501002 1547778810000,91.6594634669,7.50646720266,0.321926840668,0.507955411125,0.00418707867521 1547778815000,93.8658541197,5.63424365348,0.150200398315,0.349701828465,0.0"
benchmark1_b6 = "1547778780000,34501564,10632920,4160736 1547778785000,34501944,10632860,4160416 1547778790000,33648892,11451528,4194800 1547778795000,33184560,11507932,4602728 1547778800000,32583312,11655832,5056076 1547778805000,32180692,11884324,5230204 1547778810000,31800680,11963268,5531272 1547778815000,31550932,11963284,5781004"
benchmark2_a6 = "1547781690000,97.2144257171,0.0208151204929,0.170701147179,2.59405801519,0.0 1547781695000,99.8459925426,0.0208114814856,0.0998990605732,0.0332969153194,0.0 1547781700000,98.2411836526,0.516222679573,1.00309211881,0.130336123944,0.109165425057 1547781705000,96.5216545524,2.58691610698,0.841342830575,0.0375284289346,0.0125580811252 1547781710000,94.5368158458,4.43620338548,0.830655813059,0.192156204601,0.00416875104219 1547781715000,93.9358059052,4.57979080111,0.748519287283,0.71914830494,0.0167357014351 1547781720000,79.1951565596,17.5500761067,2.04926863989,1.15942625795,0.0460724358167 1547781725000,84.2578859378,13.6631603513,2.04534839108,0.0210328954075,0.0125724244277 1547781730000,91.1525297384,6.63301148021,0.77242855365,1.44203022773,0.0 1547781735000,91.8917430116,7.55379097766,0.241984876429,0.312481134311,0.0"
benchmark2_b6 = "1547781690000,30522192,14491560,4281468 1547781695000,31304816,13729048,4261356 1547781700000,30671536,14343924,4279760 1547781705000,30282048,14547880,4465292 1547781710000,29729708,14751512,4814000 1547781715000,28940660,15058544,5296016 1547781720000,27158760,15058560,7077900 1547781725000,26079560,15058596,8157064 1547781730000,25944436,15058680,8292104 1547781735000,25778440,15058920,8457860"

plt.figure(1)
plt.suptitle(benchmark1, color="blue")
benchmark1_t = []
for i in range(1,7):
    a = locals()['benchmark1_a'+str(i)].split(" ")
    x = []
    y_a = []
    l = 0   
    for n in a:   
        l = l + 1        
        m = n.split(",")          
        x.append(5*int(l))
        y_a.append(float('%.2f' % (float(m[2])+float(m[3]))))
    benchmark1_t.append(x[-1])
    b = locals()['benchmark1_b'+str(i)].split(" ")
    x = []
    y_b = []
    l = 0  
    for n in b:   
        l = l + 1        
        m = n.split(",")          
        x.append(5*int(l))
        y_b.append(float('%.2f' % (float(m[2])+float(m[3]))) / float('%.2f' % (float(m[1]) + float(m[2]) + float(m[3]))) * 100)
    locals()['ax'+str(i)] = plt.subplot(2,3,i)
    locals()['ax'+str(i)].set_title(locals()['t'+str(i)])
    x_axix, y_axix = (x, y_a)
    plt.plot(x_axix, y_axix, linewidth = '2', color='black', marker='x', label='CPU')
    x_axix, y_axix = (x, y_b)
    plt.plot(x_axix, y_axix, linewidth = '2', color='red', marker='o', label='RAM')
    
    ax = plt.gca()
    ax.set_ylim(0,100)
    if (i>3):
        plt.xlabel('time(sec)', fontsize=12)
    if (i==1 or i==4):
        plt.ylabel('resource usage(%)', fontsize=12)
    plt.legend()
#     ax.spines['top'].set_visible(False)
#     ax.spines['right'].set_visible(False)
plt.subplots_adjust(wspace=0.3, hspace=0.3)
# plt.show()
print benchmark1_t

benchmark2_t = []
plt.figure(2)
plt.suptitle(benchmark2, color="blue")
for i in range(1,7):
    a = locals()['benchmark2_a'+str(i)].split(" ")
    x = []
    y_a = []
    l = 0   
    for n in a:   
        l = l + 1        
        m = n.split(",")          
        x.append(5*int(l))
        y_a.append(float('%.2f' % (float(m[2])+float(m[3]))))
    benchmark2_t.append(x[-1])
    b = locals()['benchmark2_b'+str(i)].split(" ")
    x = []
    y_b = []
    l = 0  
    for n in b:   
        l = l + 1        
        m = n.split(",")          
        x.append(5*int(l))
        y_b.append(float('%.2f' % (float(m[2])+float(m[3]))) / float('%.2f' % (float(m[1]) + float(m[2]) + float(m[3]))) * 100)
    locals()['ax'+str(i)] = plt.subplot(2,3,i)
    locals()['ax'+str(i)].set_title(locals()['t'+str(i)])
    x_axix, y_axix = (x, y_a)
    plt.plot(x_axix, y_axix, linewidth = '2', color='black', marker='x', label='CPU')
    x_axix, y_axix = (x, y_b)
    plt.plot(x_axix, y_axix, linewidth = '2', color='red', marker='o', label='RAM')
    
    ax = plt.gca()
    ax.set_ylim(0,100)
    if (i>3):
        plt.xlabel('time(sec)', fontsize=12)
    if (i==1 or i==4):
        plt.ylabel('resource usage(%)', fontsize=12)
    plt.legend()
#     ax.spines['top'].set_visible(False)
#     ax.spines['right'].set_visible(False)
plt.subplots_adjust(wspace=0.3, hspace=0.3)
print benchmark2_t

plt.figure(3,figsize=(12, 6))
plt.suptitle("Configuration-performance curve", color="green")
x = []
for i in range(1,7):
    x.append(locals()['t'+str(i)])
ax1 = plt.subplot(1,2,1)
ax1.set_title(benchmark1)
y_a = benchmark1_t
x_axix, y_axix = (x, y_a)
plt.plot(x_axix, y_axix, linewidth = '2', color='black', marker='x')
ax = plt.gca()
ax.set_ylim(20,60)
plt.xlabel('configuration', fontsize=12)
plt.ylabel('job running time (sec)', fontsize=12)
plt.legend()
ax1 = plt.subplot(1,2,2)
ax1.set_title(benchmark2)
y_b = benchmark2_t
x_axix, y_axix = (x, y_b)
plt.plot(x_axix, y_axix, linewidth = '2', color='black', marker='x')
ax = plt.gca()
ax.set_ylim(40,80)
plt.xlabel('configuration', fontsize=12)
plt.ylabel('job running time (sec)', fontsize=12)
plt.legend()

plt.show()